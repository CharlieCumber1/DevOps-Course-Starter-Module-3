script:
- docker build --target test --tag todo-app:test .
- docker run todo-app:test tests
- docker run -e MONGODB_CONNECTION_STRING todo-app:test e2e_tests
deploy:
  provider: script
  script: bash deploy.sh
  on:
    branch: main
env:
  global:
  - DOCKER_USERNAME=charliecumber
  - secure: CPAHjkwOZo2p3E1W3+KaR13yZ4RAF5OlNwdugM8KbcmvF9p8B0tpTzkdBAYuBqOmp0OGkrMrHcUs31fY5g5/cH2KZ9n6xsFPRvHPTJui6i3h9UGQI4IA5hEa6TPo9qwx/6B7kKWfqlrvE5iWbzDMKXnT4M90Zx2JVNQA2ltsiBhDMEsOpl+qfStvhoTuI9EYexh2pgBXID6UVGZruM262r8ScmgIhZ12YHIt2rhMY4De+EWmvRBMrgbyMGQYU2FDQpYraQY837R/E7t5UFwzu6bqTkAd5ZeHiwO81zgEWB+xhoJqQxKuD9HVLK1qO0xfZYO1geiMS08kWZ8STGiAiKYFaW054qToStzu5r8QTw2A8ZN75cpDSvgg4Ki2/r1kVvvsvip5OUESfOIta22jn9+WMfTKDd+4IMYrWbbDQgcaKp+AQhOlYo2jhHNVIn308LivJQXqhAT/XR/hW36EKp0zZgUt2wlSgghHRQ3Is/frMeLDEKvaJMV4Cq8YQM/nqW0BKkGkaTYoLQClpstkzRjcY3ZUDAyxRDZtvD7E/Rfr7/MO/LCQ6XLUjiQB+st8rCFcASHRo7S44CKbGo+H/ocWXOnBnBwCO4b4L+EBYm7YdoYOtj25AqursTC6yLkKa0d1XtGqX4L0+tLMGgZrjaEbe3Zx2apVatLSQT4V1to=
  - secure: AumsNga0nVTVT8u1tA+bNwl5NmQxzPYYqk69KBfX2VU61Qe+rGiG/EW3UZZSgDdgZJulAIhcSToAlH86lawwchUUaxklfrl5mpoP7MPnO3LgkyL/lPRu+BVcw6MhHo3++DkeYdDyeXUkPSi+4qBODQyW3ZvDqyNZQobm2RCMHnw3GTsTZsdV+gXGD+QdOvEsnuHp24wVLHZv0wGTKCmJDWv/DxuEUGeyNecZom+fJcA9Mv2F4UWl+4+ONP03g3a2eaCFfNG4mqAjp5B9fhA8LBoBMXwmfHJmnganVMICty1P7noWTSWa8SgSkALPZemjJnT/u1MGcQTenCZyoXAnemS5QmzgqmCJwB9qt/PTfsrjKMXFUHZ1ko6zEo2uoZByDeklJmzBChbHJn4Ha2kILi4jhrADrXYshsprrkrc+KCNcYImHMYiLnV8BcZu49oCVapDJxGgeQ4yrVKRzDRAOLfgW8G1JBKE6kF4f1l5HTAClZns79i9vgvrLQTNPHmeMhJS7MwHYYYK882jcgZxnJxlEci12/FictrnrIfBVFyLyV9lKnwaw3fW198gGsX7HY8KPKvFxji4TIcP0dS84mZ2AsCKjS5c5iubWPwlD+7uGix8f8m9WOH7X4SxpYaufqVu6YiT3jl7Sq8PmtM9KFm4/RaUJ1KY2Kv3D9Y30qg=
  - secure: hvfecANUp71801mNDCCOcANgTukXmvQayeTwD9sme5UBDOnbv8uCK/6TMhn5Mn8B9P9v44M+jV0dIxp/QcsQAOIENKp0OdFOYCwYafIByEG6T5AEKfC8oto6DmyybakMzZtuhgUcyPS5BGoKrANE/06StU3UsmvRA9gLuBikaM08VK2Y9FzytcsqShyMnMqvbsqlGpXN7tTIZcs9FQM1f35smc61m+DrZeOTY2spVNUOE9z6SDp3rYAflh7KWMSHD5s2P1ZBF4qqa76la8zxEIb4QZRgCrjGcIzy/GikYaPA43AjqC06999pXqjy4/lPCbYqr1W/91LSzDEbXgwQyxPaYi6cItPuGFmt/xzoVdkfb/JsR4UE0kUII2fXIOgPHl33wgB14naEqlYAxo4OTfji6g6B3nX1yyYFuB5a3KhPaSIQ7ZHQ+7hrq/Y+Jgxa4BafK4NsQhPplXirRXxrPKU2F0EbeKuia1FliIP/lOZyRPRPwkN/ve3gEOmB8Y9pldPyKgi8mvRlLchwQY8WiBmRI63Ku+o8ji15aqBo7nNLSI9NZ6gmWxyw8U7IwMK71uqPFcePbyxdGD0wUw2BCQpL9nZJTRGvOBbJfs/FHOkcCE4Ra8hctgeRIxWre5ACqBvgSZHLdUxIARXlEdRz9vH8tfics6iMWC6Y4k6pbgI=
