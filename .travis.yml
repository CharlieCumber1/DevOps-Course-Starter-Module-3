script:
- docker build --target test --tag todo-app:test .
- docker run todo-app:test tests
- docker run -e MONGODB_USERNAME -e MONGODB_PASSWORD todo-app:test e2e_tests

deploy:
  provider: script
  script: bash deploy.sh
  on:
    branch: main

env:
  global:
  - DOCKER_USERNAME=charliecumber
  - secure: bSsIyVbO4b1OwcBDPIvgka+L8L4QEafXQ2X8cCQ7zP2ewO4Mowe+YmaMQg6SIEsN1GiqPde9IpaTjMiSbT4fpDaSWrDG/i75fFrKq2P7MbvJt3qDPmqTJWJIRbA7tXPRC0mnGehiubPlt8HWgC544HSkTIIOrpMpkRka1NVQPDOOk1BL9fMrm7GH6LT6hAZ+3/W5k9Vp7Dkvgz9J0ZH8Sv4PV7GinThnZtO2H6+nkqYVusrLy4uFbkso2lPgxNvqhMKBMmRw8bvnDT1qLtviBXfGcbAVxgplVZJ8g92IYq5in+lbuPmnm5dkGy7UzdjA1ELRqtXjOTz6S3ChQUU8Dd9lzJ2DiVwvsOrCj/O07OToKJcLd9Lc6l4BKtTg8fm/Jlpnhe8Ekhws3lXeszjfRCna2gkFiyov4PlbtTITNX9JUk4z9C647Kq8Iq4xR51DZLagUeMp80w3HmecH5u9d+R33NyOl0hCHM0syAEJxxXf4e4nIEAYaoPyjqaFlnoeeLx7J3x7YG+iMUVyxD/jRZ4jpLXVIpkgZIENuEF9uJK0MOv6h3cG/ta2kiZTYeFL0Zvps/tLEOc6sFHaQ07g8wrDwbWldTHp4s6feaIcQLIJFjRFGoyrn0PECxiEonqh2NUDllK7dyJcOvh3+eB6/vB1Amu4pERvMTi6cI+/0Xw=
  - secure: vXObwB6o3BOI97C+Ybeh18sl4TfuhIF9p063seDye69RmU1yGt8FH93IPI2rHlue/WkuuqOBFsBnn6rKopwEiS80yRs5ElB6Z2BDIT7gDTstZABaYzeM36ax0QWC0u/+nRN7Y88pnhLE6ULZVnN4/eKL+JWOIhvtRmuu7kBvBNUDEi3E1LsVvzjFL8hSTpkz8VsJjhkyifpffO0zq3gvYKxULkdx5yZSZ8BwS1Qgmng4/zJcVVc5IEZ5FITK8A98xLD0VFtlAjhUJF23PywnkhlTIsL+9pmgSyEAJA+gACgJpUKUy8JgB8xnPDeqP8pHd3/ejYTfjrALw/MNxaBjL89KDMMf/4Xr+2U9N2lZH50MRli8uj8s3942fl8w9FMv44PZSu32JXkHYhs0TF6Nektwn74Rbfc0zsJXov+hUBSF9tge86gNnqxU+QrgoxpuYtraymknEZW3dZJcGUftAS732EzkMPX+PjGJAm77NIotNKnNxTiEvX24kssTXrOng18o0yeGYpTYDD23qzEuiDerTklJbIS2U1AwC1uowfDZ7JVHlN+ZChOudiDDDk8sYuiI6lACc8KaFEdQGTFsN5lbGhGNK7dgZVhh2r1hYIpfVnIGbk2jCTLScDGUTBiCLw7LTRionVhjqPEOL7SW8CSBNXkYFBA13S1dILUGOgo=
  - secure: TFD/pYcG7+/IFY+EoRdrwOO+4Gkigr0ULkqOQ0ka8PJFnh+P5ikryJ6L9961NKrPE4Q5PEWNVbBDQVWe+x5NamGq0zOW8RaU6nGpilDJk8reBTQ/k8m7/0n/Qbbn3XYINeWp+m9a3C+0QGcVPU3fT2hJNx6EAje2lDt7hYHMM/G+2+c39nwTH4K2sg5tfy5/rucwp4i/WnU/4qHFgR2OwOohPQsoAftvhNuPN11NBp9nWuGySzOb7UHPwd7pMbSjnBQUCmITTCz0oU3X56KOcUNhmxggwmIm1KNucYKZDRTcrWttb3oUJ4E70zH7kimpkbCkiE6ApPYpmXflh+LaqqLZqVeCBS8ogjV24Rv6wTzwsauyncvKSNSoDXC1yOQPcA/5eu15s8qr1pkpSxHi7VWQb1QT1KTUyP0xEJj3XNGNJ8WfeQvKSUxeXq3ZgyuJun0DYo37IEkAPtUKOqcU9cTbiY+ycukD82KxcO+YoPljMP4GvP8XBjJs9VPru9ht3O8gRNIxN3chrzaVkd4ks+JGUufO579P+9TeUsPixX89bPGMvF/t15jENPCIaJdizpDAfwex3tme/a36Ry1pKVUGCHRwILfM4t/JXsNpMyMPaCIrcGAa2pUofgnu7buEu35WcBuo9IXjeWaPsdy52FWBda2Pw45BBQO4LLzrzPw=
  - secure: Q0ewRCWheiP8ediquuveyLO+GsxKQnFyYLixO7rNJCVG0tgI0yBoJglwYD4CK+hdNTr5IWKTc2vr8hcMU3s87HiQsP5qNJSLeqhnsn7q4wgtx8PJoSKZHHQHSfsBmEFiowxbUzowqL5sxY2jdM4jkk8AdkeewsvoPZr4D9sBz0FU2EVnglxALaJtKsYW/+hIfwRrWmyKU1K9Aaumx7xXht05KD6wlRqvQo3RB262FQDRTVj0mmF3ZKc3lmC7ElYuqdcBzsIBghs9QwUzI83P27ln8w0arWlnOzDVguqusFXJK8ZVuxN2+Gakx6MLTGoF2AOL+C/sV6RF9RwUTzM0ZsbgTcz8nsyDAZJnwjdOHoB1z2FVlFWVX1+8Q4VTySC9ZaRflb3u8tPEQaPOKoWLRvTjm0H7vSPOhEZx6stSM8MsEOZ+mLil83xyvUC9tJHfSZWZDUuOTFHFlSTQiQPGUzttm/dD9FBb1Wu7Oazyk8DCR8mkM1HjM09rw232WJR5z+4zXFcFdIyuoeoAql3F0cQaL2jsOOZ/InRQrpysMhMnEbcNBJ1+7uqVqv4Rg10Wo2kBHrkCR3zaiuWfgY1Yr7fdmsHZdrUlonWulO0ZFej1GmGIipvcpaF8eUKKFSxIiuXg/1tTyYolGeR0HRh0gjNkQ334mxPc0MUqYRiY/pU=
